{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$comment": "Generated by: https://github.com/friflo/Friflo.Json.Fliox/tree/main/Json/Fliox/Schema",
    "definitions": {
        "SyncRequest": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.DB.Protocol.ProtocolRequest.json#/definitions/ProtocolRequest" },
            "properties": {
                "type":  { "enum": ["sync"] },
                "req":   { "oneOf": [{"type": "null"}, { "$ref": "./Standard.json#/definitions/int32" }] },
                "clt":   { "type": ["string", "null"] },
                "user":  { "type": ["string", "null"] },
                "token": { "type": ["string", "null"] },
                "ack":   { "oneOf": [{"type": "null"}, { "$ref": "./Standard.json#/definitions/int32" }] },
                "tasks": { "type": "array", "items": { "$ref": "#/definitions/SyncRequestTask" } },
                "info":  {  }
            },
            "required": [
                "type",
                "tasks"
            ],
            "additionalProperties": false
        },
        "SyncRequestTask": {
            "discriminator": "task",
            "oneOf": [
                { "$ref": "#/definitions/CreateEntities" },
                { "$ref": "#/definitions/UpsertEntities" },
                { "$ref": "#/definitions/ReadEntitiesList" },
                { "$ref": "#/definitions/QueryEntities" },
                { "$ref": "#/definitions/PatchEntities" },
                { "$ref": "#/definitions/DeleteEntities" },
                { "$ref": "#/definitions/SendMessage" },
                { "$ref": "#/definitions/SubscribeChanges" },
                { "$ref": "#/definitions/SubscribeMessage" },
                { "$ref": "#/definitions/ReserveKeys" }
            ],
            "properties": {
                "info": {  }
            },
            "additionalProperties": true
        },
        "CreateEntities": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":          { "enum": ["create"] },
                "container":     { "type": "string" },
                "reservedToken": { "oneOf": [{"type": "null"}, { "$ref": "./Standard.json#/definitions/Guid" }] },
                "keyName":       { "type": ["string", "null"] },
                "entities":      { "type": "array", "items": {  } },
                "info":          {  }
            },
            "required": [
                "task",
                "container",
                "entities"
            ],
            "additionalProperties": false
        },
        "UpsertEntities": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":      { "enum": ["upsert"] },
                "container": { "type": "string" },
                "keyName":   { "type": ["string", "null"] },
                "entities":  { "type": "array", "items": {  } },
                "info":      {  }
            },
            "required": [
                "task",
                "container",
                "entities"
            ],
            "additionalProperties": false
        },
        "ReadEntitiesList": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":      { "enum": ["read"] },
                "container": { "type": "string" },
                "keyName":   { "type": ["string", "null"] },
                "isIntKey":  { "type": ["boolean", "null"] },
                "reads":     { "type": "array", "items": { "$ref": "#/definitions/ReadEntities" } },
                "info":      {  }
            },
            "required": [
                "task",
                "container",
                "reads"
            ],
            "additionalProperties": false
        },
        "ReadEntities": {
            "type": "object",
            "properties": {
                "ids":        { "type": "array", "items": { "type": "string" } },
                "references": { "type": ["array", "null"], "items": { "$ref": "#/definitions/References" } }
            },
            "required": [
                "ids"
            ],
            "additionalProperties": false
        },
        "References": {
            "type": "object",
            "properties": {
                "selector":   { "type": "string" },
                "container":  { "type": "string" },
                "keyName":    { "type": ["string", "null"] },
                "isIntKey":   { "type": ["boolean", "null"] },
                "references": { "type": ["array", "null"], "items": { "$ref": "#/definitions/References" } }
            },
            "required": [
                "selector",
                "container"
            ],
            "additionalProperties": false
        },
        "QueryEntities": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":       { "enum": ["query"] },
                "container":  { "type": "string" },
                "keyName":    { "type": ["string", "null"] },
                "isIntKey":   { "type": ["boolean", "null"] },
                "filterLinq": { "type": ["string", "null"] },
                "filter":     { "oneOf": [{"type": "null"}, { "$ref": "./Friflo.Json.Fliox.Transform.json#/definitions/FilterOperation" }] },
                "references": { "type": ["array", "null"], "items": { "$ref": "#/definitions/References" } },
                "info":       {  }
            },
            "required": [
                "task",
                "container"
            ],
            "additionalProperties": false
        },
        "PatchEntities": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":      { "enum": ["patch"] },
                "container": { "type": "string" },
                "keyName":   { "type": ["string", "null"] },
                "patches":   { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityPatch" } },
                "info":      {  }
            },
            "required": [
                "task",
                "container",
                "patches"
            ],
            "additionalProperties": false
        },
        "EntityPatch": {
            "type": "object",
            "properties": {
                "patches": { "type": "array", "items": { "$ref": "./Friflo.Json.Fliox.Transform.json#/definitions/JsonPatch" } }
            },
            "required": [
                "patches"
            ],
            "additionalProperties": false
        },
        "DeleteEntities": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":      { "enum": ["delete"] },
                "container": { "type": "string" },
                "ids":       { "type": ["array", "null"], "items": { "type": "string" } },
                "all":       { "type": ["boolean", "null"] },
                "info":      {  }
            },
            "required": [
                "task",
                "container"
            ],
            "additionalProperties": false
        },
        "SendMessage": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":  { "enum": ["message"] },
                "name":  { "type": "string" },
                "value": {  },
                "info":  {  }
            },
            "required": [
                "task",
                "name",
                "value"
            ],
            "additionalProperties": false
        },
        "SubscribeChanges": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":      { "enum": ["subscribeChanges"] },
                "container": { "type": "string" },
                "changes":   { "type": "array", "items": { "$ref": "#/definitions/Change" } },
                "filter":    { "oneOf": [{"type": "null"}, { "$ref": "./Friflo.Json.Fliox.Transform.json#/definitions/FilterOperation" }] },
                "info":      {  }
            },
            "required": [
                "task",
                "container",
                "changes"
            ],
            "additionalProperties": false
        },
        "Change": {
            "enum": [
                "create",
                "upsert",
                "patch",
                "delete"
            ]
        },
        "SubscribeMessage": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":   { "enum": ["subscribeMessage"] },
                "name":   { "type": "string" },
                "remove": { "type": ["boolean", "null"] },
                "info":   {  }
            },
            "required": [
                "task",
                "name"
            ],
            "additionalProperties": false
        },
        "ReserveKeys": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncRequestTask" },
            "properties": {
                "task":      { "enum": ["reserveKeys"] },
                "container": { "type": "string" },
                "count":     { "$ref": "./Standard.json#/definitions/int32" },
                "info":      {  }
            },
            "required": [
                "task",
                "container",
                "count"
            ],
            "additionalProperties": false
        },
        "SyncResponse": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.DB.Protocol.ProtocolResponse.json#/definitions/ProtocolResponse" },
            "properties": {
                "type":         { "enum": ["syncResp"] },
                "req":          { "oneOf": [{"type": "null"}, { "$ref": "./Standard.json#/definitions/int32" }] },
                "clt":          { "type": ["string", "null"] },
                "tasks":        { "type": ["array", "null"], "items": { "$ref": "#/definitions/SyncTaskResult" } },
                "results":      { "type": ["array", "null"], "items": { "$ref": "#/definitions/ContainerEntities" } },
                "createErrors": { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityErrors" } },
                "upsertErrors": { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityErrors" } },
                "patchErrors":  { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityErrors" } },
                "deleteErrors": { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityErrors" } },
                "info":         {  }
            },
            "required": [
                "type"
            ],
            "additionalProperties": false
        },
        "SyncTaskResult": {
            "discriminator": "task",
            "oneOf": [
                { "$ref": "#/definitions/CreateEntitiesResult" },
                { "$ref": "#/definitions/UpsertEntitiesResult" },
                { "$ref": "#/definitions/ReadEntitiesListResult" },
                { "$ref": "#/definitions/QueryEntitiesResult" },
                { "$ref": "#/definitions/PatchEntitiesResult" },
                { "$ref": "#/definitions/DeleteEntitiesResult" },
                { "$ref": "#/definitions/SendMessageResult" },
                { "$ref": "#/definitions/SubscribeChangesResult" },
                { "$ref": "#/definitions/SubscribeMessageResult" },
                { "$ref": "#/definitions/ReserveKeysResult" },
                { "$ref": "#/definitions/TaskErrorResult" }
            ],
            "properties": {

            },
            "additionalProperties": true
        },
        "CreateEntitiesResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":  { "enum": ["create"] },
                "Error": { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "CommandError": {
            "type": "object",
            "properties": {
                "message": { "type": ["string", "null"] }
            },
            "additionalProperties": false
        },
        "UpsertEntitiesResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":  { "enum": ["upsert"] },
                "Error": { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "ReadEntitiesListResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":  { "enum": ["read"] },
                "reads": { "type": "array", "items": { "$ref": "#/definitions/ReadEntitiesResult" } }
            },
            "required": [
                "task",
                "reads"
            ],
            "additionalProperties": false
        },
        "ReadEntitiesResult": {
            "type": "object",
            "properties": {
                "Error":      { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] },
                "references": { "type": ["array", "null"], "items": { "$ref": "#/definitions/ReferencesResult" } }
            },
            "additionalProperties": false
        },
        "ReferencesResult": {
            "type": "object",
            "properties": {
                "error":      { "type": ["string", "null"] },
                "container":  { "type": ["string", "null"] },
                "ids":        { "type": "array", "items": { "type": "string" } },
                "references": { "type": ["array", "null"], "items": { "$ref": "#/definitions/ReferencesResult" } }
            },
            "required": [
                "ids"
            ],
            "additionalProperties": false
        },
        "QueryEntitiesResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":       { "enum": ["query"] },
                "Error":      { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] },
                "container":  { "type": ["string", "null"] },
                "filterLinq": { "type": ["string", "null"] },
                "ids":        { "type": "array", "items": { "type": "string" } },
                "references": { "type": ["array", "null"], "items": { "$ref": "#/definitions/ReferencesResult" } }
            },
            "required": [
                "task",
                "ids"
            ],
            "additionalProperties": false
        },
        "PatchEntitiesResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":  { "enum": ["patch"] },
                "Error": { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "DeleteEntitiesResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":  { "enum": ["delete"] },
                "Error": { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "SendMessageResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":   { "enum": ["message"] },
                "Error":  { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] },
                "result": {  }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "SubscribeChangesResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task": { "enum": ["subscribeChanges"] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "SubscribeMessageResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task": { "enum": ["subscribeMessage"] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "ReserveKeysResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":  { "enum": ["reserveKeys"] },
                "Error": { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/CommandError" }] },
                "keys":  { "oneOf": [{"type": "null"}, { "$ref": "#/definitions/ReservedKeys" }] }
            },
            "required": [
                "task"
            ],
            "additionalProperties": false
        },
        "ReservedKeys": {
            "type": "object",
            "isStruct": true,
            "properties": {
                "start": { "$ref": "./Standard.json#/definitions/int64" },
                "count": { "$ref": "./Standard.json#/definitions/int32" },
                "token": { "$ref": "./Standard.json#/definitions/Guid" }
            },
            "required": [
                "start",
                "count",
                "token"
            ],
            "additionalProperties": false
        },
        "TaskErrorResult": {
            "type": "object",
            "extends": { "$ref": "#/definitions/SyncTaskResult" },
            "properties": {
                "task":       { "enum": ["error"] },
                "type":       { "$ref": "#/definitions/TaskErrorResultType" },
                "message":    { "type": ["string", "null"] },
                "stacktrace": { "type": ["string", "null"] }
            },
            "required": [
                "task",
                "type"
            ],
            "additionalProperties": false
        },
        "TaskErrorResultType": {
            "enum": [
                "None",
                "UnhandledException",
                "DatabaseError",
                "InvalidTask",
                "PermissionDenied",
                "SyncError"
            ]
        },
        "ContainerEntities": {
            "type": "object",
            "properties": {
                "container": { "type": "string" },
                "entities":  { "type": "array", "items": {  } },
                "notFound":  { "type": ["array", "null"], "items": { "type": "string" } },
                "errors":    { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityError" } }
            },
            "required": [
                "container",
                "entities"
            ],
            "additionalProperties": false
        },
        "EntityError": {
            "type": "object",
            "properties": {
                "type":    { "$ref": "#/definitions/EntityErrorType" },
                "message": { "type": ["string", "null"] }
            },
            "required": [
                "type"
            ],
            "additionalProperties": false
        },
        "EntityErrorType": {
            "enum": [
                "Undefined",
                "ParseError",
                "ReadError",
                "WriteError",
                "DeleteError",
                "PatchError"
            ]
        },
        "EntityErrors": {
            "type": "object",
            "properties": {
                "container": { "type": ["string", "null"] },
                "errors":    { "type": "object", "additionalProperties": { "$ref": "#/definitions/EntityError" } }
            },
            "required": [
                "errors"
            ],
            "additionalProperties": false
        },
        "ErrorResponse": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.DB.Protocol.ProtocolResponse.json#/definitions/ProtocolResponse" },
            "properties": {
                "type":    { "enum": ["error"] },
                "req":     { "oneOf": [{"type": "null"}, { "$ref": "./Standard.json#/definitions/int32" }] },
                "clt":     { "type": ["string", "null"] },
                "message": { "type": ["string", "null"] }
            },
            "required": [
                "type"
            ],
            "additionalProperties": false
        },
        "SubscriptionEvent": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.DB.Protocol.ProtocolEvent.json#/definitions/ProtocolEvent" },
            "properties": {
                "type":  { "enum": ["sub"] },
                "seq":   { "$ref": "./Standard.json#/definitions/int32" },
                "src":   { "type": "string" },
                "dst":   { "type": "string" },
                "tasks": { "type": ["array", "null"], "items": { "$ref": "#/definitions/SyncRequestTask" } }
            },
            "required": [
                "type",
                "seq",
                "src",
                "dst"
            ],
            "additionalProperties": false
        }
    }
}

