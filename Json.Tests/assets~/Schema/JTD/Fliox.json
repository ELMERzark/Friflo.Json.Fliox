{
    "$comment": "Generated by: https://github.com/friflo/Friflo.Json.Fliox/tree/main/Json/Fliox/Schema",
    "definitions": {
        "ProtocolMessage": {
            "discriminator": "msg",
            "mapping": {
                "sync":  { "ref":  "SyncRequest" },
                "resp":  { "ref":  "SyncResponse" },
                "error": { "ref":  "ErrorResponse" },
                "ev":    { "ref":  "EventMessage" }
            },
            "properties": {

            }
        },
        "SyncRequest": {
            "properties": {
                "req":      { "type": "int32", "nullable": true },
                "clt":      { "type": "string", "nullable": true },
                "user":     { "type": "string", "nullable": true },
                "token":    { "type": "string", "nullable": true },
                "ack":      { "type": "int32", "nullable": true },
                "tasks":    { "elements": { "ref":  "SyncRequestTask" } },
                "database": { "type": "string", "nullable": true },
                "info":     { "nullable": true }
            }
        },
        "ProtocolRequest": {
            "discriminator": "msg",
            "mapping": {
                "sync": { "ref":  "SyncRequest" }
            },
            "properties": {
                "req": { "type": "int32", "nullable": true },
                "clt": { "type": "string", "nullable": true }
            }
        },
        "SyncRequestTask": {
            "discriminator": "task",
            "mapping": {
                "create":           { "ref":  "CreateEntities" },
                "upsert":           { "ref":  "UpsertEntities" },
                "read":             { "ref":  "ReadEntities" },
                "query":            { "ref":  "QueryEntities" },
                "patch":            { "ref":  "PatchEntities" },
                "delete":           { "ref":  "DeleteEntities" },
                "message":          { "ref":  "SendMessage" },
                "command":          { "ref":  "SendCommand" },
                "subscribeChanges": { "ref":  "SubscribeChanges" },
                "subscribeMessage": { "ref":  "SubscribeMessage" },
                "reserveKeys":      { "ref":  "ReserveKeys" }
            },
            "properties": {
                "info": { "nullable": true }
            }
        },
        "CreateEntities": {
            "properties": {
                "container":     { "type": "string" },
                "reservedToken": { "ref":  "Guid", "nullable": true },
                "keyName":       { "type": "string", "nullable": true },
                "entities":      { "elements": {  } },
                "info":          { "nullable": true }
            }
        },
        "UpsertEntities": {
            "properties": {
                "container": { "type": "string" },
                "keyName":   { "type": "string", "nullable": true },
                "entities":  { "elements": {  } },
                "info":      { "nullable": true }
            }
        },
        "ReadEntities": {
            "properties": {
                "container": { "type": "string" },
                "keyName":   { "type": "string", "nullable": true },
                "isIntKey":  { "type": "boolean", "nullable": true },
                "sets":      { "elements": { "ref":  "ReadEntitiesSet" } },
                "info":      { "nullable": true }
            }
        },
        "ReadEntitiesSet": {
            "properties": {
                "ids":        { "elements": { "type": "string" } },
                "references": { "elements": { "ref":  "References" }, "nullable": true }
            }
        },
        "References": {
            "properties": {
                "selector":   { "type": "string" },
                "container":  { "type": "string" },
                "keyName":    { "type": "string", "nullable": true },
                "isIntKey":   { "type": "boolean", "nullable": true },
                "references": { "elements": { "ref":  "References" }, "nullable": true }
            }
        },
        "QueryEntities": {
            "properties": {
                "container":  { "type": "string" },
                "keyName":    { "type": "string", "nullable": true },
                "isIntKey":   { "type": "boolean", "nullable": true },
                "filterJson": { "ref":  "FilterOperation" },
                "references": { "elements": { "ref":  "References" }, "nullable": true },
                "info":       { "nullable": true }
            }
        },
        "FilterOperation": {
            "discriminator": "op",
            "mapping": {
                "equal":              { "ref":  "Equal" },
                "notEqual":           { "ref":  "NotEqual" },
                "lessThan":           { "ref":  "LessThan" },
                "lessThanOrEqual":    { "ref":  "LessThanOrEqual" },
                "greaterThan":        { "ref":  "GreaterThan" },
                "greaterThanOrEqual": { "ref":  "GreaterThanOrEqual" },
                "and":                { "ref":  "And" },
                "or":                 { "ref":  "Or" },
                "true":               { "ref":  "TrueLiteral" },
                "false":              { "ref":  "FalseLiteral" },
                "not":                { "ref":  "Not" },
                "any":                { "ref":  "Any" },
                "all":                { "ref":  "All" },
                "contains":           { "ref":  "Contains" },
                "startsWith":         { "ref":  "StartsWith" },
                "endsWith":           { "ref":  "EndsWith" }
            },
            "properties": {

            }
        },
        "Operation": {
            "discriminator": "op",
            "mapping": {
                "field":              { "ref":  "Field" },
                "string":             { "ref":  "StringLiteral" },
                "double":             { "ref":  "DoubleLiteral" },
                "int64":              { "ref":  "LongLiteral" },
                "null":               { "ref":  "NullLiteral" },
                "abs":                { "ref":  "Abs" },
                "ceiling":            { "ref":  "Ceiling" },
                "floor":              { "ref":  "Floor" },
                "exp":                { "ref":  "Exp" },
                "log":                { "ref":  "Log" },
                "sqrt":               { "ref":  "Sqrt" },
                "negate":             { "ref":  "Negate" },
                "add":                { "ref":  "Add" },
                "subtract":           { "ref":  "Subtract" },
                "multiply":           { "ref":  "Multiply" },
                "divide":             { "ref":  "Divide" },
                "min":                { "ref":  "Min" },
                "max":                { "ref":  "Max" },
                "sum":                { "ref":  "Sum" },
                "average":            { "ref":  "Average" },
                "count":              { "ref":  "Count" },
                "equal":              { "ref":  "Equal" },
                "notEqual":           { "ref":  "NotEqual" },
                "lessThan":           { "ref":  "LessThan" },
                "lessThanOrEqual":    { "ref":  "LessThanOrEqual" },
                "greaterThan":        { "ref":  "GreaterThan" },
                "greaterThanOrEqual": { "ref":  "GreaterThanOrEqual" },
                "and":                { "ref":  "And" },
                "or":                 { "ref":  "Or" },
                "true":               { "ref":  "TrueLiteral" },
                "false":              { "ref":  "FalseLiteral" },
                "not":                { "ref":  "Not" },
                "any":                { "ref":  "Any" },
                "all":                { "ref":  "All" },
                "countWhere":         { "ref":  "CountWhere" },
                "contains":           { "ref":  "Contains" },
                "startsWith":         { "ref":  "StartsWith" },
                "endsWith":           { "ref":  "EndsWith" }
            },
            "properties": {

            }
        },
        "Equal": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "BinaryBoolOp": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "Field": {
            "properties": {
                "name": { "type": "string" }
            }
        },
        "StringLiteral": {
            "properties": {
                "value": { "type": "string" }
            }
        },
        "Literal": {
            "properties": {

            }
        },
        "DoubleLiteral": {
            "properties": {
                "value": { "type": "double" }
            }
        },
        "LongLiteral": {
            "properties": {
                "value": { "type": "int64" }
            }
        },
        "NullLiteral": {
            "properties": {

            }
        },
        "Abs": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "UnaryArithmeticOp": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Ceiling": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Floor": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Exp": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Log": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Sqrt": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Negate": {
            "properties": {
                "value": { "ref":  "Operation" }
            }
        },
        "Add": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "BinaryArithmeticOp": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "Subtract": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "Multiply": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "Divide": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "Min": {
            "properties": {
                "field": { "ref":  "Field" },
                "arg":   { "type": "string" },
                "array": { "ref":  "Operation" }
            }
        },
        "BinaryAggregateOp": {
            "properties": {
                "field": { "ref":  "Field" },
                "arg":   { "type": "string" },
                "array": { "ref":  "Operation" }
            }
        },
        "Max": {
            "properties": {
                "field": { "ref":  "Field" },
                "arg":   { "type": "string" },
                "array": { "ref":  "Operation" }
            }
        },
        "Sum": {
            "properties": {
                "field": { "ref":  "Field" },
                "arg":   { "type": "string" },
                "array": { "ref":  "Operation" }
            }
        },
        "Average": {
            "properties": {
                "field": { "ref":  "Field" },
                "arg":   { "type": "string" },
                "array": { "ref":  "Operation" }
            }
        },
        "Count": {
            "properties": {
                "field": { "ref":  "Field" }
            }
        },
        "UnaryAggregateOp": {
            "properties": {
                "field": { "ref":  "Field" }
            }
        },
        "NotEqual": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "LessThan": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "LessThanOrEqual": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "GreaterThan": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "GreaterThanOrEqual": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "And": {
            "properties": {
                "operands": { "elements": { "ref":  "FilterOperation" } }
            }
        },
        "BinaryLogicalOp": {
            "properties": {
                "operands": { "elements": { "ref":  "FilterOperation" } }
            }
        },
        "Or": {
            "properties": {
                "operands": { "elements": { "ref":  "FilterOperation" } }
            }
        },
        "TrueLiteral": {
            "properties": {

            }
        },
        "FalseLiteral": {
            "properties": {

            }
        },
        "Not": {
            "properties": {
                "operand": { "ref":  "FilterOperation" }
            }
        },
        "UnaryLogicalOp": {
            "properties": {
                "operand": { "ref":  "FilterOperation" }
            }
        },
        "Any": {
            "properties": {
                "field":     { "ref":  "Field" },
                "arg":       { "type": "string" },
                "predicate": { "ref":  "FilterOperation" }
            }
        },
        "BinaryQuantifyOp": {
            "properties": {
                "field":     { "ref":  "Field" },
                "arg":       { "type": "string" },
                "predicate": { "ref":  "FilterOperation" }
            }
        },
        "All": {
            "properties": {
                "field":     { "ref":  "Field" },
                "arg":       { "type": "string" },
                "predicate": { "ref":  "FilterOperation" }
            }
        },
        "CountWhere": {
            "properties": {
                "field":     { "ref":  "Field" },
                "arg":       { "type": "string" },
                "predicate": { "ref":  "FilterOperation" }
            }
        },
        "Contains": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "StartsWith": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "EndsWith": {
            "properties": {
                "left":  { "ref":  "Operation" },
                "right": { "ref":  "Operation" }
            }
        },
        "PatchEntities": {
            "properties": {
                "container": { "type": "string" },
                "keyName":   { "type": "string", "nullable": true },
                "patches":   { "values": { "ref":  "EntityPatch" } },
                "info":      { "nullable": true }
            }
        },
        "EntityPatch": {
            "properties": {
                "patches": { "elements": { "ref":  "JsonPatch" } }
            }
        },
        "JsonPatch": {
            "discriminator": "op",
            "mapping": {
                "replace": { "ref":  "PatchReplace" },
                "add":     { "ref":  "PatchAdd" },
                "remove":  { "ref":  "PatchRemove" },
                "copy":    { "ref":  "PatchCopy" },
                "move":    { "ref":  "PatchMove" },
                "test":    { "ref":  "PatchTest" }
            },
            "properties": {

            }
        },
        "PatchReplace": {
            "properties": {
                "path":  { "type": "string" },
                "value": {  }
            }
        },
        "PatchAdd": {
            "properties": {
                "path":  { "type": "string" },
                "value": {  }
            }
        },
        "PatchRemove": {
            "properties": {
                "path": { "type": "string" }
            }
        },
        "PatchCopy": {
            "properties": {
                "path": { "type": "string" },
                "from": { "type": "string", "nullable": true }
            }
        },
        "PatchMove": {
            "properties": {
                "path": { "type": "string" },
                "from": { "type": "string", "nullable": true }
            }
        },
        "PatchTest": {
            "properties": {
                "path":  { "type": "string" },
                "value": { "nullable": true }
            }
        },
        "DeleteEntities": {
            "properties": {
                "container": { "type": "string" },
                "ids":       { "elements": { "type": "string" }, "nullable": true },
                "all":       { "type": "boolean", "nullable": true },
                "info":      { "nullable": true }
            }
        },
        "SendMessage": {
            "properties": {
                "name":  { "type": "string" },
                "value": { "nullable": true },
                "info":  { "nullable": true }
            }
        },
        "SyncMessageTask": {
            "properties": {
                "name":  { "type": "string" },
                "value": { "nullable": true },
                "info":  { "nullable": true }
            }
        },
        "SendCommand": {
            "properties": {
                "name":  { "type": "string" },
                "value": { "nullable": true },
                "info":  { "nullable": true }
            }
        },
        "SubscribeChanges": {
            "properties": {
                "container": { "type": "string" },
                "changes":   { "elements": { "ref":  "Change" } },
                "filter":    { "ref":  "FilterOperation", "nullable": true },
                "info":      { "nullable": true }
            }
        },
        "Change": {
            "enum": [
                "create",
                "upsert",
                "patch",
                "delete"
            ]
        },
        "SubscribeMessage": {
            "properties": {
                "name":   { "type": "string" },
                "remove": { "type": "boolean", "nullable": true },
                "info":   { "nullable": true }
            }
        },
        "ReserveKeys": {
            "properties": {
                "container": { "type": "string" },
                "count":     { "type": "int32" },
                "info":      { "nullable": true }
            }
        },
        "SyncResponse": {
            "properties": {
                "req":          { "type": "int32", "nullable": true },
                "clt":          { "type": "string", "nullable": true },
                "database":     { "type": "string", "nullable": true },
                "tasks":        { "elements": { "ref":  "SyncTaskResult" }, "nullable": true },
                "containers":   { "elements": { "ref":  "ContainerEntities" }, "nullable": true },
                "createErrors": { "values": { "ref":  "EntityErrors" }, "nullable": true },
                "upsertErrors": { "values": { "ref":  "EntityErrors" }, "nullable": true },
                "patchErrors":  { "values": { "ref":  "EntityErrors" }, "nullable": true },
                "deleteErrors": { "values": { "ref":  "EntityErrors" }, "nullable": true },
                "info":         { "nullable": true }
            }
        },
        "ProtocolResponse": {
            "discriminator": "msg",
            "mapping": {
                "resp":  { "ref":  "SyncResponse" },
                "error": { "ref":  "ErrorResponse" }
            },
            "properties": {
                "req": { "type": "int32", "nullable": true },
                "clt": { "type": "string", "nullable": true }
            }
        },
        "SyncTaskResult": {
            "discriminator": "task",
            "mapping": {
                "create":           { "ref":  "CreateEntitiesResult" },
                "upsert":           { "ref":  "UpsertEntitiesResult" },
                "read":             { "ref":  "ReadEntitiesResult" },
                "query":            { "ref":  "QueryEntitiesResult" },
                "patch":            { "ref":  "PatchEntitiesResult" },
                "delete":           { "ref":  "DeleteEntitiesResult" },
                "message":          { "ref":  "SendMessageResult" },
                "command":          { "ref":  "SendCommandResult" },
                "subscribeChanges": { "ref":  "SubscribeChangesResult" },
                "subscribeMessage": { "ref":  "SubscribeMessageResult" },
                "reserveKeys":      { "ref":  "ReserveKeysResult" },
                "error":            { "ref":  "TaskErrorResult" }
            },
            "properties": {

            }
        },
        "CreateEntitiesResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true }
            }
        },
        "CommandError": {
            "properties": {
                "message": { "type": "string", "nullable": true }
            }
        },
        "UpsertEntitiesResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true }
            }
        },
        "ReadEntitiesResult": {
            "properties": {
                "sets": { "elements": { "ref":  "ReadEntitiesSetResult" } }
            }
        },
        "ReadEntitiesSetResult": {
            "properties": {
                "Error":      { "ref":  "CommandError", "nullable": true },
                "references": { "elements": { "ref":  "ReferencesResult" }, "nullable": true }
            }
        },
        "ReferencesResult": {
            "properties": {
                "error":      { "type": "string", "nullable": true },
                "container":  { "type": "string", "nullable": true },
                "ids":        { "elements": { "type": "string" } },
                "references": { "elements": { "ref":  "ReferencesResult" }, "nullable": true }
            }
        },
        "QueryEntitiesResult": {
            "properties": {
                "Error":      { "ref":  "CommandError", "nullable": true },
                "container":  { "type": "string", "nullable": true },
                "ids":        { "elements": { "type": "string" } },
                "references": { "elements": { "ref":  "ReferencesResult" }, "nullable": true }
            }
        },
        "PatchEntitiesResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true }
            }
        },
        "DeleteEntitiesResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true }
            }
        },
        "SendMessageResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true }
            }
        },
        "SyncMessageResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true }
            }
        },
        "SendCommandResult": {
            "properties": {
                "Error":  { "ref":  "CommandError", "nullable": true },
                "result": { "nullable": true }
            }
        },
        "SubscribeChangesResult": {
            "properties": {

            }
        },
        "SubscribeMessageResult": {
            "properties": {

            }
        },
        "ReserveKeysResult": {
            "properties": {
                "Error": { "ref":  "CommandError", "nullable": true },
                "keys":  { "ref":  "ReservedKeys", "nullable": true }
            }
        },
        "ReservedKeys": {
            "properties": {
                "start": { "type": "int64" },
                "count": { "type": "int32" },
                "token": { "ref":  "Guid" }
            }
        },
        "TaskErrorResult": {
            "properties": {
                "type":       { "ref":  "TaskErrorResultType" },
                "message":    { "type": "string", "nullable": true },
                "stacktrace": { "type": "string", "nullable": true }
            }
        },
        "TaskErrorResultType": {
            "enum": [
                "None",
                "UnhandledException",
                "DatabaseError",
                "InvalidTask",
                "NotImplemented",
                "PermissionDenied",
                "SyncError"
            ]
        },
        "ContainerEntities": {
            "properties": {
                "container": { "type": "string" },
                "entities":  { "elements": {  } },
                "notFound":  { "elements": { "type": "string" }, "nullable": true },
                "errors":    { "values": { "ref":  "EntityError" }, "nullable": true }
            }
        },
        "EntityError": {
            "properties": {
                "type":    { "ref":  "EntityErrorType" },
                "message": { "type": "string", "nullable": true }
            }
        },
        "EntityErrorType": {
            "enum": [
                "Undefined",
                "ParseError",
                "ReadError",
                "WriteError",
                "DeleteError",
                "PatchError"
            ]
        },
        "EntityErrors": {
            "properties": {
                "container": { "type": "string", "nullable": true },
                "errors":    { "values": { "ref":  "EntityError" } }
            }
        },
        "ErrorResponse": {
            "properties": {
                "req":     { "type": "int32", "nullable": true },
                "clt":     { "type": "string", "nullable": true },
                "message": { "type": "string", "nullable": true },
                "type":    { "ref":  "ErrorResponseType" }
            }
        },
        "ErrorResponseType": {
            "enum": [
                "BadRequest",
                "Exception",
                "BadResponse"
            ]
        },
        "EventMessage": {
            "properties": {
                "seq":   { "type": "int32" },
                "src":   { "type": "string" },
                "clt":   { "type": "string" },
                "tasks": { "elements": { "ref":  "SyncRequestTask" }, "nullable": true }
            }
        },
        "ProtocolEvent": {
            "discriminator": "msg",
            "mapping": {
                "ev": { "ref":  "EventMessage" }
            },
            "properties": {
                "seq": { "type": "int32" },
                "src": { "type": "string" },
                "clt": { "type": "string" }
            }
        }
    }
}

