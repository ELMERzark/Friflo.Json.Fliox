{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$comment": "Generated by: https://github.com/friflo/Friflo.Json.Fliox#schema",
    "definitions": {
        "Right": {
            "discriminator": "type",
            "oneOf": [
                { "$ref": "#/definitions/RightAllow" },
                { "$ref": "#/definitions/RightTask" },
                { "$ref": "#/definitions/RightSendMessage" },
                { "$ref": "#/definitions/RightSubscribeMessage" },
                { "$ref": "#/definitions/RightOperation" },
                { "$ref": "#/definitions/RightPredicate" }
            ],
            "properties": {
                "type":        { "enum": ["allow", "task", "sendMessage", "subscribeMessage", "operation", "predicate"] },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type"
            ],
            "additionalProperties": true
        },
        "RightAllow": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "description": "Allow full access to the given <b>database</b>.<br/>\nIn case <b>database</b> ends with a '*' e.g. 'test*' access to all databases with the prefix 'test'\nis granted.<br/>\nUsing <b>database</b>: '*' grant access to all databases.",
            "properties": {
                "type":        { "enum": ["allow"] },
                "database":    { "type": ["string", "null"] },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type"
            ],
            "additionalProperties": false
        },
        "RightTask": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "description": "<b>RightTask</b> grant <b>database</b> access by a set of task <b>types</b>. <br/>",
            "properties": {
                "type":        { "enum": ["task"] },
                "database":    { "type": ["string", "null"] },
                "types":       { "type": "array", "items": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Tasks.json#/definitions/TaskType" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "types"
            ],
            "additionalProperties": false
        },
        "RightSendMessage": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "description": "<b>RightSendMessage</b> allows sending messages to a <b>database</b> by a set of <b>names</b>.<br/>\nEach allowed message can be listed explicit in <b>names</b>. E.g. 'std.Echo' <br/>\nA group of messages can be allowed by using a prefix. E.g. 'std.*' <br/>\nTo grant sending every message independent of its name use: '*'<br/><br/>\nNote: commands are messages - so permission of sending commands is same as for messages.",
            "properties": {
                "type":        { "enum": ["sendMessage"] },
                "database":    { "type": ["string", "null"] },
                "names":       { "type": "array", "items": { "type": "string" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "names"
            ],
            "additionalProperties": false
        },
        "RightSubscribeMessage": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "description": "<b>RightSubscribeMessage</b> allows subscribing messages send to a <b>database</b>.<br/>\nAllow subscribing a specific message by using explicit message <b>names</b>. E.g. 'std.Echo' <br/>\nAllow subscribing a group of messages by using a prefix. E.g. 'std.*' <br/>\nAllow subscribing all messages by using: '*'<br/><br/>\nNote: commands are messages - so permission of subscribing commands is same as for messages.",
            "properties": {
                "type":        { "enum": ["subscribeMessage"] },
                "database":    { "type": ["string", "null"] },
                "names":       { "type": "array", "items": { "type": "string" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "names"
            ],
            "additionalProperties": false
        },
        "RightOperation": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "description": "<b>RightOperation</b> grant <b>database</b> access for the given <b>containers</b>\nbased on a set of <b>operations</b>. <br/>\nE.g. create, read, upsert, delete, query or aggregate (count)<br/>\nIt also allows subscribing database changes by <b>subscribeChanges</b>",
            "properties": {
                "type":        { "enum": ["operation"] },
                "database":    { "type": ["string", "null"] },
                "containers":  { "additionalProperties": { "$ref": "#/definitions/ContainerAccess" }, "type": "object" },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "containers"
            ],
            "additionalProperties": false
        },
        "ContainerAccess": {
            "type": "object",
            "properties": {
                "operations":       { "type": ["array", "null"], "items": { "$ref": "#/definitions/OperationType" } },
                "subscribeChanges": { "type": ["array", "null"], "items": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Tasks.json#/definitions/Change" } }
            },
            "additionalProperties": false
        },
        "OperationType": {
            "enum": [
                "create",
                "upsert",
                "delete",
                "deleteAll",
                "patch",
                "read",
                "query",
                "aggregate",
                "mutate",
                "full"
            ]
        },
        "RightPredicate": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["predicate"] },
                "names":       { "type": "array", "items": { "type": "string" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "names"
            ],
            "additionalProperties": false
        }
    }
}

