{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$comment": "Generated by: https://github.com/friflo/Friflo.Json.Flow/tree/main/Json/Flow/Schema",
    "definitions": {
        "Right": {
            "discriminator": "type",
            "oneOf": [
                { "$ref": "#/definitions/RightAllow" },
                { "$ref": "#/definitions/RightTask" },
                { "$ref": "#/definitions/RightMessage" },
                { "$ref": "#/definitions/RightSubscribeMessage" },
                { "$ref": "#/definitions/RightDatabase" },
                { "$ref": "#/definitions/RightPredicate" }
            ],
            "properties": {
                "description": { "type": ["string", "null"] }
            },
            "additionalProperties": true
        },
        "RightAllow": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["allow"] },
                "grant":       { "type": "boolean" },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "grant"
            ],
            "additionalProperties": false
        },
        "RightTask": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["task"] },
                "types":       { "type": "array", "items": { "$ref": "#/definitions/TaskType" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "types"
            ],
            "additionalProperties": false
        },
        "RightMessage": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["message"] },
                "names":       { "type": "array", "items": { "type": "string" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "names"
            ],
            "additionalProperties": false
        },
        "RightSubscribeMessage": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["subscribeMessage"] },
                "names":       { "type": "array", "items": { "type": "string" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "names"
            ],
            "additionalProperties": false
        },
        "RightDatabase": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["database"] },
                "containers":  { "type": "object", "additionalProperties": { "$ref": "#/definitions/ContainerAccess" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "containers"
            ],
            "additionalProperties": false
        },
        "ContainerAccess": {
            "type": "object",
            "properties": {
                "operations":       { "type": ["array", "null"], "items": { "$ref": "#/definitions/OperationType" } },
                "subscribeChanges": { "type": ["array", "null"], "items": { "$ref": "#/definitions/Change" } }
            },
            "additionalProperties": false
        },
        "OperationType": {
            "enum": [
                "create",
                "update",
                "delete",
                "patch",
                "read",
                "query",
                "mutate",
                "full"
            ]
        },
        "RightPredicate": {
            "type": "object",
            "extends": { "$ref": "#/definitions/Right" },
            "properties": {
                "type":        { "enum": ["predicate"] },
                "names":       { "type": "array", "items": { "type": "string" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "type",
                "names"
            ],
            "additionalProperties": false
        },
        "TaskType": {
            "enum": [
                "read",
                "query",
                "create",
                "update",
                "patch",
                "delete",
                "message",
                "subscribeChanges",
                "subscribeMessage",
                "error"
            ]
        },
        "Change": {
            "enum": [
                "create",
                "update",
                "patch",
                "delete"
            ]
        },
        "Role": {
            "type": "object",
            "properties": {
                "id":          { "type": "string" },
                "rights":      { "type": "array", "items": { "$ref": "#/definitions/Right" } },
                "description": { "type": ["string", "null"] }
            },
            "required": [
                "id",
                "rights"
            ],
            "additionalProperties": false
        },
        "UserCredential": {
            "type": "object",
            "properties": {
                "id":       { "type": "string" },
                "passHash": { "type": ["string", "null"] },
                "token":    { "type": ["string", "null"] }
            },
            "required": [
                "id"
            ],
            "additionalProperties": false
        },
        "UserPermission": {
            "type": "object",
            "properties": {
                "id":    { "type": "string" },
                "roles": { "type": ["string", "null"] }
            },
            "required": [
                "id"
            ],
            "additionalProperties": false
        }
    }
}

