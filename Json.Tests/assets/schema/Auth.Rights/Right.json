{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/definitions/Role",
    "definitions": {
        "Right": {
            "oneOf": [
                { "$ref": "#/definitions/RightAllow" },
                { "$ref": "#/definitions/RightDatabase" },
                { "$ref": "#/definitions/RightMessage" },
                { "$ref": "#/definitions/RightSubscribeMessage" },
                { "$ref": "#/definitions/RightPredicate" },
                { "$ref": "#/definitions/RightTask" }
            ]
        },
        "RightAllow": {
            "type": "object",
            "properties": {
                "type":         { "enum": [ "allow" ] },
                "grant":        { "type": "boolean" }
            },
            "additionalProperties": false
        },
        "RightDatabase": {
            "type": "object",
            "properties": {
                "type":         { "enum": [ "database" ] },
                "containers":   { "type": "object",
                    "additionalProperties": { "$ref": "#/definitions/ContainerAccess" }
                }
            },
            "additionalProperties": false
        },
        "ContainerAccess": {
            "type": "object",
            "properties": {
                "operations":   { "type": "array",
                    "items": { "enum": [ "create", "update", "delete", "patch", "read", "query", "mutate", "full" ] }
                },
                "subscribeChanges": { "type": "array",
                    "items": { "enum": [ "create", "update", "delete", "patch" ] }
                }
            },
            "additionalProperties": false
        },
        "RightMessage": {
            "type": "object",
            "properties": {
                "type":         { "enum": [ "message" ] },
                "names":        { "type": "array",
                    "items":        { "type": "string" }
                }
            },
            "additionalProperties": false
        },
        "RightSubscribeMessage": {
            "type": "object",
            "properties": {
                "type":         { "enum": [ "subscribeMessage" ] },
                "names":        { "type": "array",
                    "items":        { "type": "string" }
                }
            },
            "additionalProperties": false
        },
        "RightPredicate": {
            "type": "object",
            "properties": {
                "type":         { "enum": [ "predicate" ] },
                "names":        { "type": "array",
                    "items":        { "type": "string" }
                }
            },
            "additionalProperties": false
        },
        "RightTask": {
            "type": "object",
            "properties": {
                "type":         { "enum": [ "task" ] },
                "types":        { "type": "array",
                    "items":        { "enum": [
                        "read", "query", "create", "update", "patch", "delete",
                        "message", "subscribeChanges", "subscribeMessage"] }
                }
            },
            "additionalProperties": false
        }
    }
}
