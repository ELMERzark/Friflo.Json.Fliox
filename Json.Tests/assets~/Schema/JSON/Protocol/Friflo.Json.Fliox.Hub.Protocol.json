{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$comment": "Generated by: https://github.com/friflo/Friflo.Json.Fliox#schema",
    "definitions": {
        "SyncRequest": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.ProtocolRequest.json#/definitions/ProtocolRequest" },
            "properties": {
                "msg":      { "enum": ["sync"] },
                "req":      { "oneOf": [{ "$ref": "./Standard.json#/definitions/int32" }, {"type": "null"}], "description": "Used only for <b>RemoteClientHub</b> to enable:\n<p>\n1. Out of order response handling for their corresponding requests.\n</p><p>\n2. Multiplexing of requests and their responses for multiple clients e.g. <b>FlioxClient</b>\nusing the same connection.\nThis is not a common scenario but it enables using a single <b>WebSocketClientHub</b>\nused by multiple clients.\n</p>\nThe host itself only echos the <b>reqId</b> to <b>reqId</b> and\ndoes <b>not</b> utilize it internally." },
                "clt":      { "type": ["string", "null"] },
                "user":     { "type": ["string", "null"], "description": "Identify the user performing a sync request.\nIn case using of using <b>UserAuthenticator</b> the <b>userId</b> and <b>token</b>\nare use for user authentication." },
                "token":    { "type": ["string", "null"] },
                "ack":      { "oneOf": [{ "$ref": "./Standard.json#/definitions/int32" }, {"type": "null"}], "description": "<b>eventAck</b> is used to ensure (change) events are delivered reliable.\nA client set <b>eventAck</b> to the last received <b>seq</b> in case\nit has subscribed to database changes by a <b>SubscribeChanges</b> task.\nOtherwise <b>eventAck</b> is null." },
                "tasks":    { "type": "array", "items": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Tasks.json#/definitions/SyncRequestTask" } },
                "database": { "type": ["string", "null"] },
                "info":     {  }
            },
            "required": [
                "msg",
                "tasks"
            ],
            "additionalProperties": false
        },
        "SyncResponse": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.ProtocolResponse.json#/definitions/ProtocolResponse" },
            "properties": {
                "msg":          { "enum": ["resp"] },
                "req":          { "oneOf": [{ "$ref": "./Standard.json#/definitions/int32" }, {"type": "null"}], "description": "Set to the value of the corresponding <b>reqId</b>" },
                "clt":          { "type": ["string", "null"], "description": "Set to <b>clientId</b> of a <b>SyncRequest</b> in case the given\n<b>clientId</b> was valid. Otherwise it is set to null. <br/>\nCalling <b>EnsureValidClientId()</b> when <b>clientId</b> == null a\nnew unique client id will be assigned. <br/>\nFor tasks which require a <b>clientId</b> a client need to set <b>clientId</b>\nto <b>clientId</b>. <br/>\nThis enables tasks like <b>SubscribeMessage</b> or <b>SubscribeChanges</b> identifying the\n<b>EventMessage</b> target." },
                "database":     { "type": ["string", "null"] },
                "tasks":        { "type": ["array", "null"], "items": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Tasks.json#/definitions/SyncTaskResult" } },
                "containers":   { "type": ["array", "null"], "items": { "$ref": "#/definitions/ContainerEntities" } },
                "createErrors": { "additionalProperties": { "$ref": "#/definitions/EntityErrors" }, "type": "object" },
                "upsertErrors": { "additionalProperties": { "$ref": "#/definitions/EntityErrors" }, "type": "object" },
                "patchErrors":  { "additionalProperties": { "$ref": "#/definitions/EntityErrors" }, "type": "object" },
                "deleteErrors": { "additionalProperties": { "$ref": "#/definitions/EntityErrors" }, "type": "object" },
                "info":         {  }
            },
            "required": [
                "msg"
            ],
            "additionalProperties": false
        },
        "ContainerEntities": {
            "type": "object",
            "properties": {
                "container": { "type": "string" },
                "count":     { "oneOf": [{ "$ref": "./Standard.json#/definitions/int32" }, {"type": "null"}], "description": "Is only set when using a <b>RemoteHostHub</b> to show the number of <b>entities</b>\nin a serialized protocol message to avoid counting them by hand when debugging.\nIt is not used by the library as it is redundant information." },
                "entities":  { "type": "array", "items": {  } },
                "notFound":  { "type": ["array", "null"], "items": { "type": "string" } },
                "errors":    { "additionalProperties": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Models.json#/definitions/EntityError" }, "type": "object" }
            },
            "required": [
                "container",
                "entities"
            ],
            "additionalProperties": false
        },
        "EntityErrors": {
            "type": "object",
            "properties": {
                "container": { "type": ["string", "null"] },
                "errors":    { "additionalProperties": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Models.json#/definitions/EntityError" }, "type": "object" }
            },
            "required": [
                "errors"
            ],
            "additionalProperties": false
        },
        "ErrorResponse": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.ProtocolResponse.json#/definitions/ProtocolResponse" },
            "properties": {
                "msg":     { "enum": ["error"] },
                "req":     { "oneOf": [{ "$ref": "./Standard.json#/definitions/int32" }, {"type": "null"}], "description": "Set to the value of the corresponding <b>reqId</b>" },
                "clt":     { "type": ["string", "null"], "description": "Set to <b>clientId</b> of a <b>SyncRequest</b> in case the given\n<b>clientId</b> was valid. Otherwise it is set to null. <br/>\nCalling <b>EnsureValidClientId()</b> when <b>clientId</b> == null a\nnew unique client id will be assigned. <br/>\nFor tasks which require a <b>clientId</b> a client need to set <b>clientId</b>\nto <b>clientId</b>. <br/>\nThis enables tasks like <b>SubscribeMessage</b> or <b>SubscribeChanges</b> identifying the\n<b>EventMessage</b> target." },
                "message": { "type": ["string", "null"] },
                "type":    { "$ref": "#/definitions/ErrorResponseType" }
            },
            "required": [
                "msg",
                "type"
            ],
            "additionalProperties": false
        },
        "ErrorResponseType": {
            "enum": [
                "BadRequest",
                "Exception",
                "BadResponse"
            ]
        },
        "EventMessage": {
            "type": "object",
            "extends": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.ProtocolEvent.json#/definitions/ProtocolEvent" },
            "properties": {
                "msg":   { "enum": ["ev"] },
                "seq":   { "$ref": "./Standard.json#/definitions/int32" },
                "src":   { "type": "string" },
                "clt":   { "type": "string" },
                "tasks": { "type": ["array", "null"], "items": { "$ref": "./Friflo.Json.Fliox.Hub.Protocol.Tasks.json#/definitions/SyncRequestTask" }, "description": "Contains the events an application subscribed. These are:\n<ul><li><b>CreateEntities</b></li><li><b>UpsertEntities</b></li><li><b>DeleteEntities</b></li><li><b>PatchEntities</b></li><li><b>SendMessage</b></li><li><b>SendCommand</b></li></ul>" }
            },
            "required": [
                "msg",
                "seq",
                "src",
                "clt"
            ],
            "additionalProperties": false
        }
    }
}

